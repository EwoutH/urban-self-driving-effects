# Research log
This section describes how each of the sub-questions was approached, which methods were used and which practices applied.

## Overview
A simulation model was constructed. In this process the Modeling & Simulation (M&S) lifecycle (REF) was followed, approaching the problem in a 5 step process: (1) Problem Definition, (2) Conceptual Modeling, (3) Specification, (4) Implementation and (5) Experimentation. The problem definition was described in the introduction, the conceptual model, specification (including data) and implementation are discussed in the Model overview chapter. In this process Ockham's razor (REF) is applied as sharp as possible to the problem, to at every step exclude unneeded complexity. Peer and supervisor feedback was also requested and incorporated frequently.

The model creating followed ABM and DES best practices, including defining system boundaries, component decomposition, identifying agents, states, behaviors and interactions, and structured experimenting and observing both key metrics and emergent behaviors. An overview of the resulting model is given following the revised ODD protocol (REF).

## Implementation & tools
The model was implemented in Python and relevant ABM and traffic libraries, using Python 3.12, Mesa 3.0.0b1 and a modified version of UXsim 1.6.0, along the regular suite of scientific Python packages for data analysis and visualisation. Python was chosen for its low complexity, rich ecosystem and the authors familiarity with the language (being a Mesa maintainer, among other things). Some other languages, like Julia or Rust might be faster, but would slow down model development due to being a lower level language. Mesa is currently the leading ABM package, and was selected for it's ability to easily manage large numbers of agents, including activation and data collection.

It was identified a mesoscopic simulation package was needed for the traffic submodel. Many software was considered, including proprietary ones like AIMSUN and the open-source SUMO and MATSim. The requirement being able to collect data, and be controlled froma Python hybrid ABM/DES model almost made an open-source Python implementation that could be modified a requirement in itself. UXsim was finally selected for being a native Python implementation, and relatively high mesoscopic performance. The traffic mechanics (Newell's simplified car-following model, which is a type of Kinematic Wave model) was fitting for the required detail, resolution and accuracy.

UXsim was heavily modified to fit the requirements of this study. Among others, it was made compatible OSMxn graphs to be able to use OpenStreetMap road networks, optimized performance for route search and homogenous dynamic user optimization (DUO), added the concept of areasm, to be able to both add demand from areas to other areas, and to collect data per area. The UXsim core developer, Toru Seo, supported significantly in this effort, for which many thanks.

## Verification, Validation and Accreditation
Different forms of validation and verification where considered and applied, following the Verification, Validation, and Accreditation (VV&A) Framework (REF). To verify a correct implementation, the whole model development was tracked in git, notable and unexpected behavior was included in the commit messsages and the model was ran in CI on every commit, with the key KPIs and sometimes other validation data where outputted, which could and often were inspected. This validated that the model kept running and was consistent in output. Before committing a new change, manual validation of the new feature was done, often using debugging, printing or plotting relevant values and metrics. Due to the stochastic nature of the model, hard unittests where difficult to write, since model outputs varied slightly between each run, so samples where inspected and manual validated, to be able to verify that they fit into expected ranges.

Validation was more difficult, since a future with large scale AV adoption doesn't exist yet. What could be done however was aligning the model with current real world behavior. Mode shares, mode distance shares and mode shares to specific areas were validated and slightly calibrated to existing ODiN 2022 and 2023 data (which were very similar). One note here was that ODiN showed largere heterogenity in mode shares among areas, indicating some latent variable(s) / underlying behavior mechanics hasn't been captured by the model yet, which is consistent with the simple mode choice model implemented.

For validation of the mesoscopic traffic network, which was constructed using OpenStreetMap data, an attempt was done to validate network speeds at certain times of days. We reached out to multiple navigation and mapping companies, but of the approached none where willing to share data under academic terms.

Accreditation possibilities were limited because of the lack of invested stakeholders, but weekly supervisor meetings were conducted to ensure support for the reserach direction.

## Design of Experiments (DoE)
For sub-questions B, C and D experimental designs were created. For question B and C uncertaincies were identified. Multiple sampling techniques to get scenarios from those uncertainties where concisdered. (pseudo) monto-carlo and hybrid latin cube were considered, but rejected due to they difficulty in visualising and interpreting. A full-factorial design did increase computational load, but. Log-like intervals were choosen, often scaling parameters with a certain factor. For subquestion B mode choice shares were interpreted, and for subquestion C high-level KPIs were analysed.

To answer subquestion D policies were inventarised. To show the models capabilities, at least one policy that directly inflenced agent mode choice and at least one that modified the network were required. Here a subset of scenarios was picked from the full factorial design, to reduce computational load, in which very similar scenarios were removed. This allowed testing the most interesting futures on a different set of policies.